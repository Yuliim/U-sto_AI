import os
import pandas as pd
import numpy as np
from faker import Faker
import random
from datetime import datetime, timedelta


BASE_DIR = os.path.dirname(os.path.abspath(__file__))
SAVE_DIR = os.path.join(BASE_DIR, "data_lifecycle")
os.makedirs(SAVE_DIR, exist_ok=True) # í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±
# ---------------------------------------------------------
# 0. ì„¤ì • ë° ì´ˆê¸°í™”
# ---------------------------------------------------------
fake = Faker('ko_KR')  # í•œêµ­ì–´ ë”ë¯¸ ë°ì´í„° ìƒì„±ê¸°
TOTAL_COUNT = 5000     # ìƒì„±í•  ë°ì´í„° ê°œìˆ˜ (ì•½ 5000ê±´)

# ìŠ¹ì¸ ìƒíƒœ ë¹„ìœ¨ ì„¤ì • (í™•ì • 97%, ëŒ€ê¸° 2%, ë°˜ë ¤ 1%)
APPROVAL_RATIOS = [0.97, 0.02, 0.01]
APPROVAL_STATUSES = ['í™•ì •', 'ëŒ€ê¸°', 'ë°˜ë ¤']
REMARK_TEMPLATES_BY_CLASS = {
    # IT / ì „ì‚° ì¥ë¹„
    "ë…¸íŠ¸ë¶ì»´í“¨í„°": [
        "AI ì‹¤ìŠµ ìˆ˜ì—…ìš© ë…¸íŠ¸ë¶",
        "ì „ì‚° ì‹¤ìŠµì‹¤ ê³µìš© ì¥ë¹„",
        "êµìˆ˜Â·ì—°êµ¬ì› ì—…ë¬´ìš©",
        "í•™ê³¼ ê³µìš© ì „ì‚° ìì‚°"
    ],
    "ë°ìŠ¤í¬í†±ì»´í“¨í„°": [
        "ì „ì‚° ì‹¤ìŠµì‹¤ ê³ ì •í˜• PC",
        "ì—°êµ¬ì‹¤ ë¶„ì„ ì—…ë¬´ìš©",
        "í–‰ì • ì—…ë¬´ìš© ë°ìŠ¤í¬í†±"
    ],
    "ì•¡ì •ëª¨ë‹ˆí„°": [
        "ì „ì‚° ì‹¤ìŠµì‹¤ ë³´ì¡° ëª¨ë‹ˆí„°",
        "ì‚¬ë¬´í™˜ê²½ ê°œì„ ìš©",
        "ì—°êµ¬ì‹¤ ë‹¤ì¤‘ í™”ë©´ êµ¬ì„±ìš©"
    ],
    "í—ˆë¸Œ": [
        "ì „ì‚°ë§ í™•ì¶©ìš©",
        "ì‹¤ìŠµì‹¤ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ìš©"
    ],
    "ë¼ìš°í„°": [
        "ì‹¤ìŠµì‹¤ ë„¤íŠ¸ì›Œí¬ ì¦ì„¤",
        "í•™ê³¼ ì „ì‚°ë§ ê³ ë„í™”"
    ],
    "í•˜ë“œë””ìŠ¤í¬ë“œë¼ì´ë¸Œ": [
        "ì—°êµ¬ ë°ì´í„° ì €ì¥ìš©",
        "ì„œë²„ ì¦ì„¤ìš© ìŠ¤í† ë¦¬ì§€"
    ],
    "í”Œë˜ì‹œë©”ëª¨ë¦¬ì €ì¥ì¥ì¹˜": [
        "êµìœ¡ ìë£Œ ë°°í¬ìš©",
        "ë°±ì—… ë§¤ì²´"
    ],
    "ìŠ¤ìºë„ˆ": [
        "í–‰ì • ë¬¸ì„œ ì „ì‚°í™”",
        "ìë£Œ ë””ì§€í„¸ ì•„ì¹´ì´ë¹™"
    ],
    "ë ˆì´ì €í”„ë¦°í„°": [
        "í–‰ì • ë¬¸ì„œ ì¶œë ¥ìš©",
        "í•™ê³¼ ê³µìš© í”„ë¦°í„°"
    ],

    # ê°€êµ¬ / ì§‘ê¸°
    "ì±…ìƒ": [
        "ê°•ì˜ì‹¤ í™˜ê²½ ê°œì„ ",
        "ì—°êµ¬ì‹¤ ì§‘ê¸° êµì²´",
        "ì‹ ê·œ ì—°êµ¬ì‹¤ êµ¬ì¶•"
    ],
    "ì‘ì—…ìš©ì˜ì": [
        "ì‚¬ë¬´í™˜ê²½ ê°œì„ ",
        "ë…¸í›„ ì§‘ê¸° êµì²´"
    ],
    "ì±…ê±¸ìƒ": [
        "ê°•ì˜ì‹¤ ì§‘ê¸° êµì²´",
        "ë…¸í›„ ì±…ê±¸ìƒ êµì²´"
    ],
    "ì„œëí˜•ìˆ˜ë‚©ì¥": [
        "ì—°êµ¬ì‹¤ ë¬¸ì„œ ë³´ê´€ìš©",
        "í–‰ì • ìë£Œ ìˆ˜ë‚©ìš©"
    ],

    # êµìœ¡ ê¸°ìì¬
    "ì¹ íŒë³´ì¡°ì¥": [
        "ê°•ì˜ì‹¤ ê¸°ìì¬ ë³´ê°•",
        "ë…¸í›„ ê¸°ìì¬ êµì²´"
    ],
    "ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œ": [
        "ìŠ¤ë§ˆíŠ¸ ê°•ì˜ì‹¤ êµ¬ì¶•",
        "ë””ì§€í„¸ ê°•ì˜ í™˜ê²½ ê°œì„ "
    ],
}

# ---------------------------------------------------------
# 1. ë§ˆìŠ¤í„° ë°ì´í„° ì •ì˜ (Master Data)
# ---------------------------------------------------------
# 1-1. G2B í’ˆëª© ë§ˆìŠ¤í„° (17ê°œ í‘œì¤€ í’ˆëª©)
# êµ¬ì¡°: [ë¬¼í’ˆë¶„ë¥˜ì½”ë“œ(8), ë¬¼í’ˆì‹ë³„ì½”ë“œ(8), í’ˆëª©ëª…, ë¶„ë¥˜ëª…, ë‚´ìš©ì—°ìˆ˜, í‰ê· ë‹¨ê°€(ì›)]
# ìº í¼ìŠ¤ ì„¤ì •
CAMPUS_TYPES = ['ì„œìš¸', 'ERICA']
CAMPUS_PROBS = [0.5, 0.5] # 5:5 ë¹„ìœ¨
'''
# ê¸°ì¡´ ìƒ˜í”Œ ë°ì´í„°
G2B_MASTER_DATA = [
    # IT ê¸°ê¸°
    ("43211503", "26103121",
     "ë…¸íŠ¸ë¶ì»´í“¨í„°, Asus, (CN)B3605CCA-CP0004X, Intel Core Ultra 7 255H(2GHz), ì•¡ì„¸ì‚¬ë¦¬ë³„ë„",
     "ë…¸íŠ¸ë¶ì»´í“¨í„°", 6, 1800000),

    ("43211507", "26111329",
     "ë°ìŠ¤í¬í†±ì»´í“¨í„°, í•œì„±ì»´í“¨í„°, K15-5B71651V0, (ë‚´)Ultra 5 235(3.4GHz)/(ì™¸)Ultra 5 225(3.3GHz)",
     "ë°ìŠ¤í¬í†±ì»´í“¨í„°", 5, 1200000),

    ("43211902", "26108810",
     "ì•¡ì •ëª¨ë‹ˆí„°, ì•ŒíŒŒìŠ¤ìº”ë””ìŠ¤í”Œë ˆì´, (CN)16T20, 39.5cm",
     "ì•¡ì •ëª¨ë‹ˆí„°", 5, 250000),

    ("43222610", "25578661",
     "í—ˆë¸Œ, Belkin, (US)INC002, 7port",
     "í—ˆë¸Œ", 5, 90000),

    ("45111601", "25414806",
     "í¬ì¸í„°, ì´ˆì´ìŠ¤í…Œí¬ë†€ë¡œì§€, XPM180Y, ìœ íš¨ê±°ë¦¬ 50m",
     "í¬ì¸í„°", 5, 60000),

    ("43201803", "26048280",
     "í•˜ë“œë””ìŠ¤í¬ë“œë¼ì´ë¸Œ, Lenovo, (CN)4XB7A88027, 22TB",
     "í•˜ë“œë””ìŠ¤í¬ë“œë¼ì´ë¸Œ", 6, 750000),

    ("43222609", "26066170",
     "ë¼ìš°í„°, Netgear, (US)PR60X",
     "ë¼ìš°í„°", 6, 550000),

    ("43202005", "25605835",
     "í”Œë˜ì‹œë©”ëª¨ë¦¬ì €ì¥ì¥ì¹˜, Sandisk, (CN)EXTREME PRO SDXC, 64GB",
     "í”Œë˜ì‹œë©”ëª¨ë¦¬ì €ì¥ì¥ì¹˜", 4, 40000),

    ("43211711", "26101603",
     "ìŠ¤ìºë„ˆ, Kodak alaris, (CN)E1040, 600dpi",
     "ìŠ¤ìºë„ˆ", 6, 900000),

    ("44101601", "26057578",
     "ì¢…ì´ì ˆë‹¨ê¸°, Siser north america, (CN)Romeo, 920Ã—180Ã—200mm",
     "ì¢…ì´ì ˆë‹¨ê¸°", 8, 650000),

    # ê°€êµ¬ ë° ìˆ˜ë‚©
    ("56101703", "26113315",
     "ì±…ìƒ, ì‹ í¥, SH-DEAGB11, 1180Ã—780Ã—600~1130mm, 1ì¸ìš©",
     "ì±…ìƒ", 10, 350000),

    ("56112102", "26112769",
     "ì‘ì—…ìš©ì˜ì, ì—ì½”ìš°ë“œ, ECO-L003H, 610Ã—680Ã—1185mm",
     "ì‘ì—…ìš©ì˜ì", 10, 220000),

    ("56112108", "24928465",
     "ì±…ê±¸ìƒ, ì˜ìê³µì¥ í”ŒëŸ¬ìŠ¤, PLU-PL01, 575Ã—700Ã—830mm",
     "ì±…ê±¸ìƒ", 10, 180000),

    ("56101597", "25964887",
     "ì„œëí˜•ìˆ˜ë‚©ì¥, ë¼ì˜¨ì‹œìŠ¤í…œê°€êµ¬, D-400-60-2, 500Ã—400Ã—558mm",
     "ì„œëí˜•ìˆ˜ë‚©ì¥", 10, 200000),

    # êµìœ¡ìš© ë³´ì¡°ì¥Â·ì „ìì¹ íŒÂ·í”„ë¦°í„°
    ("56121798", "25656485",
     "ì¹ íŒë³´ì¡°ì¥, ì •ìš´ì‹œìŠ¤í…œ, JWBB18212, (ë¶€í’ˆ)ì „ìì¹ íŒê±°ì¹˜íŒ, 1800Ã—235Ã—1200mm",
     "ì¹ íŒë³´ì¡°ì¥", 10, 800000),

    ("44111911", "26082440",
     "ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œ, ë³´ì„±ì „ì, BSI-P24K, 59.94cm, ì „ììœ ë„ë°©ì‹/ì „ìíœ/ì „ìêµíƒí˜•",
     "ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œ", 7, 2981000),

    ("43212105", "25911926",
     "ë ˆì´ì €í”„ë¦°í„°, Ricoh, (CN)P 310, A4/í‘ë°±/32ppm",
     "ë ˆì´ì €í”„ë¦°í„°", 5, 350000),
]
'''
# ë°±ì—”ë“œê°€ ë³´ë‚´ì¤€ ì¡°ë‹¬ì²­ ì¡°ë‹¬ë°ì´í„°í—ˆë¸Œì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„° ìƒ˜í”Œ, í•˜ì§€ë§Œ ë‚´ìš©ì—°ìˆ˜ê°€ ì—†ì–´ ê¸°ì¡´ ë°ì´í„° ê²ƒì„ ì§‘ì–´ë„£ìŒ.
G2B_MASTER_DATA = [
    # =========================
    # ì „ìÂ·ì •ë³´Â·í†µì‹ Â·ì˜ìƒ (10)
    # =========================
    ("43211503", "25832088",  # ë¬¼í’ˆë¶„ë¥˜ì½”ë“œ 43211503 / ë¬¼í’ˆì‹ë³„ì½”ë“œ 25832088
     "25832088 ë…¸íŠ¸ë¶ì»´í“¨í„°, ì •í˜„ì”¨ì•¤ì”¨, 15GW13-55U161T, Intel Core i7 1355U(1.7GHz), ì•¡ì„¸ì‚¬ë¦¬ë³„ë„",  # í’ˆëª©ëª… = ì‹ë³„ë²ˆí˜¸ + ì‹ë³„ëª…
     "43211503 ë…¸íŠ¸ë¶ì»´í“¨í„°",  # ë¶„ë¥˜ëª… = ë¶„ë¥˜ë²ˆí˜¸ + ë¶„ë¥˜ëª…
     6,  # ë‚´ìš©ì—°ìˆ˜ = ë…¸íŠ¸ë¶ ê´€í–‰ ê°’
     1895000),  # í‰ê· ë‹¨ê°€ = ê³„ì•½ë‹¨ê°€ í‰ê· 

    ("43211507", "25251643",  # ë°ìŠ¤í¬í†±
     "25251643 ë°ìŠ¤í¬í†±ì»´í“¨í„°, ì—ì´ì¹˜ì¼€ì´ì‹œìŠ¤í…œ, HKDI-DP9HA, Intel Core i7 13700(2.1GHz)",
     "43211507 ë°ìŠ¤í¬í†±ì»´í“¨í„°",
     5,
     1803500),

    ("43211902", "24493061",  # ëª¨ë‹ˆí„°
     "24493061 ì•¡ì •ëª¨ë‹ˆí„°, ì—˜ì§€ì „ì, (CN)22MP410, 54.5cm",
     "43211902 LCDíŒ¨ë„ë˜ëŠ”ëª¨ë‹ˆí„°",
     5,
     271608),

    ("43212105", "23858386",  # ë ˆì´ì €í”„ë¦°í„°
     "23858386 ë ˆì´ì €í”„ë¦°í„°, í•œêµ­í›„ì§€ì œë¡ìŠ¤, (CN)B205, A4/í‘ë°±/20ppm",
     "43212105 ë ˆì´ì €í”„ë¦°í„°",
     5,
     338000),

    ("43211711", "24204348",  # ìŠ¤ìºë„ˆ
     "24204348 ìŠ¤ìºë„ˆ, ìºë…¼ì½”ë¦¬ì•„, (CN)DR-C230, 600dpi",
     "43211711 ìŠ¤ìºë„ˆ",
     6,
     980000),

    ("43222609", "23908131",  # ë¼ìš°í„°
     "23908131 ë„¤íŠ¸ì›Œí¬ë¼ìš°í„°, í‹°í”¼ë§í¬, (CN)ER605, ê¸°ê°€ë¹„íŠ¸",
     "43222609 ë„¤íŠ¸ì›Œí¬ë¼ìš°í„°",
     6,
     210000),

    ("43201803", "23809899",  # HDD
     "23809899 í•˜ë“œë””ìŠ¤í¬ë“œë¼ì´ë¸Œ, Hitachi vantara, (US)R2H-H10RSS, 10TB",
     "43201803 í•˜ë“œë””ìŠ¤í¬ë“œë¼ì´ë¸Œ",
     6,
     4337420),

    ("43223308", "22060848",  # ë„¤íŠ¸ì›Œí¬ ë™
     "22060848 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™, 600Ã—2000Ã—750mm",
     "43223308 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™",
     8,
     891700),

    ("43223308", "22065235",  # ë„¤íŠ¸ì›Œí¬ ë™
     "22065235 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™, 600Ã—1800Ã—750mm",
     "43223308 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™",
     8,
     789290),

    ("43223308", "22060847",  # ë„¤íŠ¸ì›Œí¬ ë™
     "22060847 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™, 600Ã—1200Ã—750mm",
     "43223308 ë„¤íŠ¸ì›Œí¬ì‹œìŠ¤í…œì¥ë¹„ìš©ë™",
     8,
     717550),

    # =========================
    # ì‚¬ë¬´Â·êµìœ¡Â·ê°€êµ¬ (10)
    # =========================
    ("56101703", "25114372",  # ì±…ìƒ
     "25114372 ì±…ìƒ, ìš°ë“œë¦¼, WD-WIZDE100, 2700Ã—2150Ã—750mm, 1ì¸ìš©",
     "56101703 ì±…ìƒ",
     10,
     6000000),

    ("56112102", "24128496",  # ì‘ì—…ìš©ì˜ì
     "24128496 ì‘ì—…ìš©ì˜ì, ì˜¤í”¼ìŠ¤ì•ˆê±´ì‚¬, AC-051, 513Ã—520Ã—783mm",
     "56112102 ì‘ì—…ìš©ì˜ì",
     10,
     91000),

    ("56112108", "24917370",  # ì±…ê±¸ìƒ(ì½¤ë¹„ì˜ì)
     "24917370 ì±…ê±¸ìƒ, ì• ë‹ˆì²´, AMD-WT100A, 617Ã—790Ã—850mm",
     "56112108 ì±…ìƒìš©ì½¤ë¹„ì˜ì",
     10,
     465000),

    ("56121798", "25616834",  # ì¹ íŒë³´ì¡°ì¥
     "25616834 ì¹ íŒë³´ì¡°ì¥, í¬ë¡œë°”ê°€êµ¬, ACFBA14, 5400Ã—519Ã—2400mm",
     "56121798 ì¹ íŒë³´ì¡°ì¥",
     10,
     6000000),

    ("44111911", "25460962",  # ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œ
     "25460962 ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œ, ë„¤ì˜¤í”„ëœë“œ, NEOM-ON86, 217.2cm, On Cell",
     "44111911 ì¸í„°ë™í‹°ë¸Œí™”ì´íŠ¸ë³´ë“œë°ì•¡ì„¸ì„œë¦¬",
     7,
     6000000),

    ("56122001", "24430269",  # ì‹¤ìŠµëŒ€
     "24430269 ì‹¤ìŠµëŒ€, ëŠ˜í‘¸ë¦„ê°€êµ¬, NSLK-7A, 2200Ã—1100Ã—770mm",
     "56122001 ì‹¤ìŠµëŒ€",
     10,
     1050000),

    ("56122001", "27501019",  # ì‹¤í—˜ëŒ€
     "27501019 ì‹¤í—˜ëŒ€, ìš°ë“œê·¸ë¼í”¼, DW-8-202301, 1400Ã—900Ã—750mm, ì¤‘ì•™í˜•",
     "56122001 ì‹¤í—˜ëŒ€",
     10,
     755000),

    ("56101502", "61454987",  # ì†ŒíŒŒ 1ì¸
     "61454987 ì†ŒíŒŒ, í¬ë¨¸ìŠ¤, DYDH-3101-Z, 880Ã—795Ã—790mm, 1ì¸ìš©",
     "56101502 ì†ŒíŒŒ",
     10,
     560000),

    ("56101502", "57803211",  # ì†ŒíŒŒ 2ì¸
     "57803211 ì†ŒíŒŒ, í¬ë¨¸ìŠ¤, FMBOB-2-Z, 1200Ã—690Ã—755mm, 2ì¸ìš©",
     "56101502 ì†ŒíŒŒ",
     10,
     521000),

    ("56112105", "23266810",  # ë¼ìš´ì§€ìš©ì˜ì
     "23266810 ë¼ìš´ì§€ìš©ì˜ì, ì›ì¼í¼ë‹ˆì²˜, WIAP0310, 1570Ã—650Ã—850mm, 3ì¸ìš©",
     "56112105 ë¼ìš´ì§€ìš©ì˜ì",
     10,
     500000),
]

# 1-2. ë¶€ì„œ ë§ˆìŠ¤í„° (ì¡°ì§ë„)
DEPT_MASTER_DATA = [
    ("C354", "ì†Œí”„íŠ¸ì›¨ì–´ìœµí•©ëŒ€í•™RCí–‰ì •íŒ€(ERICA)"),
    ("C352", "ê³µí•™ëŒ€í•™RCí–‰ì •íŒ€(ERICA)"),
    ("C364", "ê²½ìƒëŒ€í•™RCí–‰ì •íŒ€(ERICA)"),
    ("C360", "ê¸€ë¡œë²Œë¬¸í™”í†µìƒëŒ€í•™RCí–‰ì •íŒ€(ERICA)"),
    ("A351", "ì‹œì„¤íŒ€(ERICA)"),
    ("A320", "í•™ìƒì§€ì›íŒ€(ERICA)"),
]
# ---------------------------------------------------------
# [ìˆ˜ì •] í˜„ì‹¤ ê¸°ë°˜ í™•ë¥  ë¶„í¬ ì„¤ì • (Items & Departments)
# ---------------------------------------------------------

# 1. ì „ì²´ ë¬¼í’ˆ ì¤‘ í•´ë‹¹ ë¬¼í’ˆì´ ì„ íƒë  í™•ë¥  (ì´ 20ê°œ í•­ëª©)
# ìˆœì„œëŠ” G2B_MASTER_DATA ë¦¬ìŠ¤íŠ¸ì˜ ì •ì˜ ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
# (ë…¸íŠ¸ë¶, ë°ìŠ¤í¬í†±, ëª¨ë‹ˆí„°, í”„ë¦°í„°, ìŠ¤ìºë„ˆ, ë¼ìš°í„°, HDD, ë™2000, ë™1800, ë™1200, 
#  ì±…ìƒ, ì˜ì, ì±…ê±¸ìƒ, ì¹ íŒì¥, í™”ì´íŠ¸ë³´ë“œ, ì‹¤ìŠµëŒ€, ì‹¤í—˜ëŒ€, ì†ŒíŒŒ1, ì†ŒíŒŒ2, ë¼ìš´ì§€ì˜ì)
ITEM_WEIGHTS = [
    0.180, 0.140, 0.220, 0.045, 0.020, 0.015, 0.012, 0.004, 0.004, 0.003, # IT (64.3%)
    0.040, 0.120, 0.065, 0.009, 0.007, 0.018, 0.015, 0.018, 0.015, 0.040  # ê°€êµ¬ (35.7%)
]

# 2. ê° ë¬¼í’ˆë³„ ë¶€ì„œ êµ¬ë§¤ ë¹„ìœ¨ (ì¸ë±ìŠ¤: G2B_MASTER_DATAì˜ ì¸ë±ìŠ¤)
# ë¶€ì„œ ìˆœì„œ: [C354(ì†Œí”„íŠ¸), C352(ê³µí•™), C364(ê²½ìƒ), C360(ê¸€ë¡œë²Œ), A351(ì‹œì„¤), A320(í•™ìƒ)]
DEPT_WEIGHTS_BY_ITEM = {
    # === IT / ì „ì‚° ì¥ë¹„ ===
    0: [0.18, 0.20, 0.10, 0.07, 0.10, 0.35], # ë…¸íŠ¸ë¶
    1: [0.20, 0.22, 0.08, 0.05, 0.15, 0.30], # ë°ìŠ¤í¬í†±
    2: [0.17, 0.20, 0.09, 0.07, 0.12, 0.35], # ëª¨ë‹ˆí„°
    3: [0.14, 0.12, 0.08, 0.06, 0.15, 0.45], # ë ˆì´ì €í”„ë¦°í„°
    4: [0.12, 0.10, 0.08, 0.05, 0.20, 0.45], # ìŠ¤ìºë„ˆ
    5: [0.03, 0.04, 0.01, 0.01, 0.85, 0.06], # ë¼ìš°í„°
    6: [0.02, 0.03, 0.01, 0.01, 0.88, 0.05], # HDD
    7: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (2000mm)
    8: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (1800mm)
    9: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (1200mm)
    
    # === ì‚¬ë¬´ / ê°€êµ¬ ===
    10: [0.18, 0.20, 0.15, 0.12, 0.20, 0.15], # ì±…ìƒ
    11: [0.20, 0.22, 0.15, 0.13, 0.15, 0.15], # ì‘ì—…ìš©ì˜ì
    12: [0.18, 0.30, 0.20, 0.22, 0.05, 0.05], # ì±…ê±¸ìƒ
    13: [0.20, 0.30, 0.25, 0.15, 0.08, 0.02], # ì¹ íŒë³´ì¡°ì¥
    14: [0.22, 0.32, 0.20, 0.14, 0.10, 0.02], # í™”ì´íŠ¸ë³´ë“œ
    15: [0.20, 0.40, 0.10, 0.05, 0.20, 0.05], # ì‹¤ìŠµëŒ€
    16: [0.15, 0.45, 0.10, 0.05, 0.20, 0.05], # ì‹¤í—˜ëŒ€
    17: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ì†ŒíŒŒ(1ì¸)
    18: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ì†ŒíŒŒ(2ì¸)
    19: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ë¼ìš´ì§€ìš©ì˜ì
}
# ---------------------------------------------------------
# 2. ë°ì´í„° ìƒì„± ë¡œì§ (Phase 1)
# ---------------------------------------------------------
# ---------------------------------------------------------
# [ìˆ˜ì •] í˜„ì‹¤ ê¸°ë°˜ í™•ë¥  ë¶„í¬ ì„¤ì • (Items & Departments)
# ---------------------------------------------------------
# 1. ì „ì²´ ë¬¼í’ˆ ì¤‘ í•´ë‹¹ ë¬¼í’ˆì´ ì„ íƒë  í™•ë¥  (ì´ 20ê°œ í•­ëª©)
# G2B_MASTER_DATA ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•¨
ITEM_WEIGHTS = [
    0.180, 0.140, 0.220, 0.045, 0.020, 0.015, 0.012, 0.004, 0.004, 0.003, # IT (64.3%)
    0.040, 0.120, 0.065, 0.009, 0.007, 0.018, 0.015, 0.018, 0.015, 0.040  # ê°€êµ¬ (35.7%)
]

# 2. ê° ë¬¼í’ˆë³„ ë¶€ì„œ êµ¬ë§¤ ë¹„ìœ¨ (ì¸ë±ìŠ¤: G2B_MASTER_DATAì˜ ì¸ë±ìŠ¤)
# ë¶€ì„œ ìˆœì„œ: [C354(ì†Œí”„íŠ¸), C352(ê³µí•™), C364(ê²½ìƒ), C360(ê¸€ë¡œë²Œ), A351(ì‹œì„¤), A320(í•™ìƒ)]
DEPT_WEIGHTS_BY_ITEM = {
    # === IT / ì „ì‚° ì¥ë¹„ ===
    0: [0.18, 0.20, 0.10, 0.07, 0.10, 0.35], # ë…¸íŠ¸ë¶
    1: [0.20, 0.22, 0.08, 0.05, 0.15, 0.30], # ë°ìŠ¤í¬í†±
    2: [0.17, 0.20, 0.09, 0.07, 0.12, 0.35], # ëª¨ë‹ˆí„°
    3: [0.14, 0.12, 0.08, 0.06, 0.15, 0.45], # ë ˆì´ì €í”„ë¦°í„°
    4: [0.12, 0.10, 0.08, 0.05, 0.20, 0.45], # ìŠ¤ìºë„ˆ
    5: [0.03, 0.04, 0.01, 0.01, 0.85, 0.06], # ë¼ìš°í„°
    6: [0.02, 0.03, 0.01, 0.01, 0.88, 0.05], # HDD
    7: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (2000mm)
    8: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (1800mm)
    9: [0.00, 0.01, 0.00, 0.00, 0.95, 0.04], # ë™ (1200mm)
    
    # === ì‚¬ë¬´ / ê°€êµ¬ ===
    10: [0.18, 0.20, 0.15, 0.12, 0.20, 0.15], # ì±…ìƒ
    11: [0.20, 0.22, 0.15, 0.13, 0.15, 0.15], # ì‘ì—…ìš©ì˜ì
    12: [0.18, 0.30, 0.20, 0.22, 0.05, 0.05], # ì±…ê±¸ìƒ
    13: [0.20, 0.30, 0.25, 0.15, 0.08, 0.02], # ì¹ íŒë³´ì¡°ì¥
    14: [0.22, 0.32, 0.20, 0.14, 0.10, 0.02], # í™”ì´íŠ¸ë³´ë“œ
    15: [0.20, 0.40, 0.10, 0.05, 0.20, 0.05], # ì‹¤ìŠµëŒ€
    16: [0.15, 0.45, 0.10, 0.05, 0.20, 0.05], # ì‹¤í—˜ëŒ€
    17: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ì†ŒíŒŒ(1ì¸)
    18: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ì†ŒíŒŒ(2ì¸)
    19: [0.05, 0.05, 0.10, 0.15, 0.10, 0.55], # ë¼ìš´ì§€ìš©ì˜ì
}

# ---------------------------------------------------------
# 1. ë°ì´í„° ìƒì„± í•¨ìˆ˜ ì •ì˜
# ---------------------------------------------------------
def generate_acquisition_data(count):
    print(f"ğŸš€ [Phase 1] í˜„ì‹¤ ê¸°ë°˜ ë¬¼í’ˆ ì·¨ë“ ë°ì´í„° {count}ê±´ ìƒì„±ì„ ì‹œì‘í•©ë‹ˆë‹¤...")
    
    acquisition_list = []
    
    # ê¸°ì¤€ì¼ì ì„¤ì •
    now = datetime.now()
    today = datetime(now.year, now.month, now.day)
    
    # ë¬¼í’ˆ ì¸ë±ìŠ¤ ë¦¬ìŠ¤íŠ¸ (0 ~ 19)
    item_indices = range(len(G2B_MASTER_DATA))

    for _ in range(count):
        # -------------------------------------------------
        # 1) ê¸°ë³¸ ì •ë³´ ì„ íƒ (ê°€ì¤‘ì¹˜ ì ìš©)
        # -------------------------------------------------
        # ë¬¼í’ˆ ì„ ì •
        selected_idx = random.choices(item_indices, weights=ITEM_WEIGHTS, k=1)[0]
        g2b_item = G2B_MASTER_DATA[selected_idx]
        
        # ë¶€ì„œ ì„ ì • (ë¬¼í’ˆë³„ ê°€ì¤‘ì¹˜ ì ìš©)
        dept_weights = DEPT_WEIGHTS_BY_ITEM[selected_idx]
        dept = random.choices(DEPT_MASTER_DATA, weights=dept_weights, k=1)[0]
        
        # G2B ì •ë³´ ì–¸íŒ¨í‚¹
        class_code, id_code, item_name, class_name, life_years, base_price = g2b_item
        g2b_full_code = class_code + id_code # 16ìë¦¬ ëª©ë¡ë²ˆí˜¸
        
        # -------------------------------------------------
        # 2) ìŠ¹ì¸ ìƒíƒœ ê²°ì • (í™•ì •/ëŒ€ê¸°/ë°˜ë ¤)
        # -------------------------------------------------
        approval_status = np.random.choice(APPROVAL_STATUSES, p=APPROVAL_RATIOS)
        
        # -------------------------------------------------
        # 3) ë‚ ì§œ ìƒì„± ë¡œì§ (ë””í…Œì¼ ìœ ì§€)
        # -------------------------------------------------
        start_date_range = datetime(2015, 1, 1)
        
        # 'ëŒ€ê¸°' ìƒíƒœëŠ” ìµœê·¼(2024ë…„ 10ì›” ì´í›„)ì— ëª°ë ¤ìˆë„ë¡ ì„¤ì •
        if approval_status == 'ëŒ€ê¸°':
            wait_start = datetime(2024, 10, 1)
            # wait_startê°€ todayë³´ë‹¤ ë¯¸ë˜ì¸ ê²½ìš° ë°©ì§€
            if wait_start > today: wait_start = today
            temp_date = fake.date_between(start_date=wait_start, end_date=today)
        else:
            temp_date = fake.date_between(start_date=start_date_range, end_date=today)
        
        # datetime ê°ì²´ ë³€í™˜
        acq_date = datetime(temp_date.year, temp_date.month, temp_date.day)

        # ìº í¼ìŠ¤ ëœë¤ ë°°ì •
        campus = np.random.choice(CAMPUS_TYPES, p=CAMPUS_PROBS)
        
        # -------------------------------------------------
        # 4) ì •ë¦¬ì¼ì ìƒì„±
        # -------------------------------------------------
        clear_date = None
        if approval_status == 'í™•ì •':
            random_days = random.randint(3, 14)
            clear_date = (acq_date + timedelta(days=random_days))
            # ì •ë¦¬ì¼ìëŠ” í˜„ì¬ ë‚ ì§œë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ì œí•œ
            if clear_date > today:
                clear_date = today
                
        # -------------------------------------------------
        # 5) ìˆ˜ëŸ‰ ë° ê¸ˆì•¡ ìƒì„± (í’ˆëª©ë³„ ì°¨ì´ ë°˜ì˜)
        # -------------------------------------------------
        # ì±…ìƒ/ì˜ìë¥˜ëŠ” ëŒ€ëŸ‰ êµ¬ë§¤ ê°€ëŠ¥ì„± ë†’ìŒ
        if "ì±…ìƒ" in item_name or "ì˜ì" in item_name:
            # ì˜ì/ì±…ìƒ: 1~5ê°œ(ì†Œê·œëª¨) vs 10~50ê°œ(ê°•ì˜ì‹¤) í˜¼í•© ë¶„í¬
            quantity = random.choices([random.randint(1, 5), random.randint(10, 50)], weights=[0.7, 0.3])[0]
        elif "PC" in item_name or "ë…¸íŠ¸ë¶" in item_name:
             # PCë¥˜: 1~5ëŒ€(ê°œì¸/ì—°êµ¬ì‹¤) vs 20~40ëŒ€(ì‹¤ìŠµì‹¤)
            quantity = random.choices([random.randint(1, 5), random.randint(20, 40)], weights=[0.85, 0.15])[0]
        else:
            # ê¸°íƒ€ ì¥ë¹„: ì†ŒëŸ‰
            quantity = random.randint(1, 5)
            
        # ì·¨ë“ê¸ˆì•¡ = (ë‹¨ê°€ * ìˆ˜ëŸ‰) + ëœë¤ ë…¸ì´ì¦ˆ(ì˜µì…˜ê°€ ë“± Â±10%)
        unit_price = int(base_price * random.uniform(0.9, 1.1)) 
        total_amount = unit_price * quantity
        total_amount = (total_amount // 1000) * 1000 # 1000ì› ë‹¨ìœ„ ì ˆì‚­
        
        # -------------------------------------------------
        # 6) ê¸°íƒ€ ì†ì„± (ì·¨ë“ì •ë¦¬êµ¬ë¶„, ë¹„ê³ )
        # -------------------------------------------------
        acq_method = np.random.choice(['ìì²´êµ¬ì…', 'ìì²´ì œì‘', 'ê¸°ì¦'], p=[0.95, 0.02, 0.03])
        
        remark = ""
        if approval_status == 'ë°˜ë ¤':
            remark = "ì˜ˆì‚° ì´ˆê³¼ë¡œ ì¸í•œ ë°˜ë ¤"
        elif random.random() < 0.1: # 10% í™•ë¥ ë¡œ ë¹„ê³  ìƒì„±
            # ë¬¼í’ˆ ë¶„ë¥˜(í’ˆëª©ëª… í‚¤ì›Œë“œ)ì— ë§ëŠ” ë¹„ê³  í…œí”Œë¦¿ ì„ íƒ
            # G2B_MASTER_DATAì˜ 4ë²ˆì§¸ ìš”ì†Œ(class_name) í™œìš©
            # ì˜ˆ: "43211503 ë…¸íŠ¸ë¶ì»´í“¨í„°" -> "ë…¸íŠ¸ë¶ì»´í“¨í„°" ì¶”ì¶œ ì‹œë„
            try:
                key_candidate = class_name.split(' ')[1]
            except:
                key_candidate = class_name
                
            candidates = REMARK_TEMPLATES_BY_CLASS.get(key_candidate, [])
            # ë§¤í•‘ ì‹¤íŒ¨ ì‹œ í¬ê´„ì ì¸ í‚¤ì›Œë“œë¡œ ì¬ì‹œë„ (ì˜ˆ: ì»´í“¨í„° -> ë°ìŠ¤í¬í†±)
            if not candidates:
                if "ì»´í“¨í„°" in item_name: candidates = REMARK_TEMPLATES_BY_CLASS.get("ë°ìŠ¤í¬í†±ì»´í“¨í„°", [])
                elif "ì˜ì" in item_name: candidates = REMARK_TEMPLATES_BY_CLASS.get("ì‘ì—…ìš©ì˜ì", [])
            
            if candidates:
                remark = random.choice(candidates)

        # ë¬¸ìì—´ ë³€í™˜
        acq_date_str = acq_date.strftime('%Y-%m-%d')
        clear_date_str = clear_date.strftime('%Y-%m-%d') if clear_date else ""

        # -------------------------------------------------
        # 7) ë°ì´í„° ì ì¬
        # -------------------------------------------------
        row = {
            # ì‹ë³„ ì •ë³´
            'G2B_ëª©ë¡ë²ˆí˜¸': g2b_full_code,
            'G2B_ëª©ë¡ëª…': item_name,
            # G2B ìƒì„¸ (ì¡°íšŒìš©)
            'ë¬¼í’ˆë¶„ë¥˜ì½”ë“œ': class_code,
            'ë¬¼í’ˆë¶„ë¥˜ëª…': class_name,
            'ë¬¼í’ˆì‹ë³„ì½”ë“œ': id_code,
            'ë¬¼í’ˆí’ˆëª©ëª…': item_name, 
            'ìº í¼ìŠ¤': campus,  
            
            # ì·¨ë“ ì •ë³´
            'ì·¨ë“ì¼ì': acq_date_str,
            'ì·¨ë“ê¸ˆì•¡': total_amount,
            'ì •ë¦¬ì¼ì': clear_date_str,
            'ì·¨ë“ì •ë¦¬êµ¬ë¶„': acq_method,
            
            # ê´€ë¦¬ ì •ë³´
            'ìš´ìš©ë¶€ì„œ': dept[1],
            'ìš´ìš©ë¶€ì„œì½”ë“œ': dept[0],
            'ìš´ìš©ìƒíƒœ': 'ì·¨ë“',
            'ë‚´ìš©ì—°ìˆ˜': life_years,
            'ìˆ˜ëŸ‰': quantity,
            'ìŠ¹ì¸ìƒíƒœ': approval_status,
            'ë¹„ê³ ': remark
        }
        acquisition_list.append(row)
        
    # DataFrame ë³€í™˜
    df_acquisition = pd.DataFrame(acquisition_list)
    return df_acquisition
# ---------------------------------------------------------
# 3. ê²°ê³¼ ì €ì¥ (CSV Export)
# ---------------------------------------------------------

# í•¨ìˆ˜ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°í”„ë ˆì„ ìƒì„±
df_acquisition = generate_acquisition_data(TOTAL_COUNT)

# [03-01] ë¬¼í’ˆ ì·¨ë“ ëŒ€ì¥ ëª©ë¡ (Main Output)
# í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¶”ì¶œí•˜ì—¬ ì €ì¥
cols_acquisition = [
    'G2B_ëª©ë¡ë²ˆí˜¸', 'G2B_ëª©ë¡ëª…', 'ìº í¼ìŠ¤', 'ì·¨ë“ì¼ì', 'ì·¨ë“ê¸ˆì•¡', 'ì •ë¦¬ì¼ì', 
    'ìš´ìš©ë¶€ì„œ', 'ìš´ìš©ìƒíƒœ', 'ë‚´ìš©ì—°ìˆ˜', 'ìˆ˜ëŸ‰', 'ìŠ¹ì¸ìƒíƒœ', 
    'ì·¨ë“ì •ë¦¬êµ¬ë¶„', 'ìš´ìš©ë¶€ì„œì½”ë“œ', 'ë¹„ê³ '
]
df_acquisition[cols_acquisition].to_csv(os.path.join(SAVE_DIR, '03_01_acquisition_master.csv'), index=False, encoding='utf-8-sig')

# [03-02] G2B ëª©ë¡ ì¡°íšŒìš© (Popup Output)
# ë¶„ë¥˜ ëª©ë¡ (ì¤‘ë³µ ì œê±°)
df_class = df_acquisition[['ë¬¼í’ˆë¶„ë¥˜ì½”ë“œ', 'ë¬¼í’ˆë¶„ë¥˜ëª…']].drop_duplicates()
df_class.to_csv(os.path.join(SAVE_DIR, '03_02_g2b_class_list.csv'), index=False, encoding='utf-8-sig')

# í’ˆëª© ëª©ë¡ (ì¤‘ë³µ ì œê±°)
df_item = df_acquisition[['ë¬¼í’ˆì‹ë³„ì½”ë“œ', 'ë¬¼í’ˆí’ˆëª©ëª…', 'ë¬¼í’ˆë¶„ë¥˜ì½”ë“œ']].drop_duplicates()
df_item.to_csv(os.path.join(SAVE_DIR, '03_02_g2b_item_list.csv'), index=False, encoding='utf-8-sig')

print("âœ… [Phase 1] ë°ì´í„° ìƒì„± ì™„ë£Œ!")
print(f"   - ì´ {len(df_acquisition)}ê±´ì˜ ì·¨ë“ ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")
print("   - ì €ì¥ íŒŒì¼: 03_01_acquisition_master.csv, 03_02_g2b_class_list.csv, 03_02_g2b_item_list.csv")
print("   - ìŠ¹ì¸ ìƒíƒœ ë¶„í¬:")
print(df_acquisition['ìŠ¹ì¸ìƒíƒœ'].value_counts())